<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generador de Memorial</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

<style>
/* BODY */
body {
    font-family: 'Poppins', sans-serif;
    background: linear-gradient(135deg, #ece9e6, #ffffff);
    display: flex;
    justify-content: center;
    align-items: flex-start;
    min-height: 100vh;
    padding: 40px 20px;
    color: #333;
}

/* CONTENEDOR */
.container {
    background: #fff;
    max-width: 700px;
    width: 100%;
    padding: 40px 50px;
    border-radius: 20px;
    box-shadow: 0 15px 35px rgba(0,0,0,0.1);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}
.container:hover {
    transform: translateY(-5px);
    box-shadow: 0 25px 50px rgba(0,0,0,0.15);
}

/* TITULO */
.container h2 {
    text-align: center;
    margin-bottom: 35px;
    font-size: 32px;
    font-weight: 700;
    color: #222;
}

/* LABEL */
label {
    display: block;
    margin-top: 20px;
    margin-bottom: 8px;
    font-weight: 600;
    color: #555;
}

/* INPUT Y TEXTAREA */
input[type="text"],
input[type="file"],
textarea {
    width: 100%;
    padding: 15px 18px;
    border-radius: 12px;
    border: 1px solid #ddd;
    font-size: 16px;
    background: #fdfdfd;
    transition: all 0.3s ease;
    outline: none;
    box-shadow: inset 0 2px 5px rgba(0,0,0,0.03);
}
input[type="text"]:focus,
textarea:focus,
input[type="file"]:focus {
    border-color: #f2b927;
    box-shadow: 0 0 8px rgba(242, 185, 39, 0.4);
    background: #fff;
}

/* TEXTAREA */
textarea {
    resize: vertical;
    min-height: 100px;
}

/* BOTÓN */
button {
    width: 100%;
    padding: 16px;
    margin-top: 30px;
    font-size: 18px;
    font-weight: 700;
    color: #fff;
    background: linear-gradient(135deg, #f2b927, #d49e17);
    border: none;
    border-radius: 15px;
    cursor: pointer;
    transition: all 0.4s ease;
    box-shadow: 0 8px 20px rgba(0,0,0,0.2);
}
button:hover {
    transform: translateY(-3px) scale(1.02);
    box-shadow: 0 15px 35px rgba(0,0,0,0.25);
}

/* EFECTO FOCUS SUAVE */
input:focus, textarea:focus {
    transform: scale(1.02);
}

/* RESPONSIVE */
@media (max-width: 768px) {
    .container {
        padding: 30px 25px;
    }
    .container h2 {
        font-size: 28px;
    }
    input[type="text"], textarea, input[type="file"], button {
        font-size: 16px;
        padding: 12px 15px;
    }
}
</style>



</head>

<body>
<div class="container">

    <h2>Generador de Página Memorial</h2>

    <label>Nombre</label>
    <input type="text" id="nombre">

    <label>Fechas</label>
    <input type="text" id="fechas">

    <label>Descripción (Acerca de)</label>
    <textarea id="acerca" rows="5"></textarea>

    <label>Nombre del Cementerio</label>
    <input type="text" id="cementerio_nombre">

    <label>Ubicación del Cementerio</label>
    <input type="text" id="cementerio_ubicacion">

    <label>Foto del Logo</label>
    <input type="file" id="foto_header">

    <label>Foto del Fondo</label>
    <input type="file" id="foto_hero">

    <label>Foto del Perfil</label>
    <input type="file" id="foto_perfil">

    <label>Fotos de la Galería</label>
    <input type="file" id="galeria" multiple>

    <button onclick="generar()">Generar Página</button>

</div>

<script>
async function generar() {

    const zip = new JSZip();
    const carpeta = zip.folder("memorial");

    // PLANTILLA BASE (pegarás tu index.html completo aquí)
    let plantilla = `
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Memorial {{NOMBRE}}</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>

<header class="header">
<img src="images/foto_header.png" class="logo">
</header>

<div class="hero">
    <img src="images/{{FOTO_HERO}}">
    <div class="hero-fade"></div>
</div>

<section class="profile-section">

    <div class="profile-photo">
        <img src="images/{{FOTO_PERFIL}}">
    </div>

    <div class="info-section">
        <div class="subtitle">En memoria de</div>
        <h2>{{NOMBRE}}</h2>
        <div class="dates">{{FECHAS}}</div>
    </div>

    <div class="tabs">
        <button class="tab active" onclick="showTab('acerca')">Acerca de</button>
        <button class="tab" onclick="showTab('imagenes')">Fotos</button>
    </div>
</section>

<section class="content">

<div id="acerca" class="tab-content" style="display: block;">
    {{ACERCA_DE}}
</div>

<div id="imagenes" class="tab-content" style="display: none;">
    <div class="gallery">
        {{GALERIA_IMAGENES}}
    </div>
</div>

<footer class="footer">
    <div class="cemetery-info">
        <h3>Informacion Del Cementerio</h3>
        <p><strong>Nombre:</strong> {{CEMENTERIO_NOMBRE}} </p>
        <p><strong>Ubicacion:</strong> {{CEMENTERIO_UBICACION}}</p>
    </div>
</footer>

<script>
function showTab(tabName) {
    document.querySelectorAll('.tab').forEach(btn => btn.classList.remove('active'));
    document.querySelectorAll('.tab-content').forEach(c => c.style.display = 'none');
    document.querySelector(\`[onclick="showTab('\${tabName}')"]\`).classList.add('active');
    document.getElementById(tabName).style.display = 'block';
}
<\/script>


</body>
</html>`;

    // REEMPLAZAR VARIABLES
    plantilla = plantilla.replace(/{{NOMBRE}}/g, document.getElementById("nombre").value);
    plantilla = plantilla.replace("{{FECHAS}}", document.getElementById("fechas").value);

let acercaTexto = document.getElementById("acerca").value
    .replace(/&/g, "&amp;")
    .replace(/</g, "&lt;")
    .replace(/>/g, "&gt;")
    .replace(/\n/g, "<br>"); // respeta enters
plantilla = plantilla.replace("{{ACERCA_DE}}", `<div style="
    max-width: 100%;
    word-wrap: break-word;
    overflow-wrap: break-word;
    white-space: pre-wrap;
">${acercaTexto}</div>`);

    plantilla = plantilla.replace("{{CEMENTERIO_NOMBRE}}", document.getElementById("cementerio_nombre").value);
    plantilla = plantilla.replace("{{CEMENTERIO_UBICACION}}", document.getElementById("cementerio_ubicacion").value);

    // FOTO HEADER
    const files = {
        FOTO_HEADER: document.getElementById("foto_header").files[0],
        FOTO_HERO: document.getElementById("foto_hero").files[0],
        FOTO_PERFIL: document.getElementById("foto_perfil").files[0]
    };

    const imgFolder = carpeta.folder("images");

    for (const key in files) {
        if (files[key]) {
            const data = await files[key].arrayBuffer();
            let filename = "";
            if (key === "FOTO_HEADER") filename = "foto_header.png";
            if (key === "FOTO_HERO") filename = files[key].name;
            if (key === "FOTO_PERFIL") filename = files[key].name;

            imgFolder.file(filename, data);
            plantilla = plantilla.replace(`{{${key}}}`, filename);
        }
    }

    // GALERÍA
    let galeriaHTML = "";
    const galeria = document.getElementById("galeria").files;
    let count = 1;

    for (let file of galeria) {
        const data = await file.arrayBuffer();
        const filename = `galeria_${count}.png`;
        imgFolder.file(filename, data);
        galeriaHTML += `<img src="images/${filename}">`;
        count++;
    }

    plantilla = plantilla.replace("{{GALERIA_IMAGENES}}", galeriaHTML);

    // AGREGAR INDEX
    carpeta.file("index.html", plantilla);

    // Guardar styles.css
// Guardar styles.css
const cssContenido = `/* GENERAL */
body { margin: 0; background: #ffffff; font-family: "Segoe UI", sans-serif; color: #333; }
.header { text-align: center; padding: 10px 0; background: #fffffff8; overflow: hidden; }
.header .logo { width: 120px; height: auto; object-fit: contain; }

/* HERO CON OVERLAY */
.hero { width: 100%; height: 600px; position: relative; overflow: hidden; }
.hero img { width: 100%; height: 100%; object-fit: cover; display: block; }
.hero-fade { position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
    background: linear-gradient(to bottom, rgba(0,0,0,0.3), rgba(0,0,0,0.3)); pointer-events: none; }

.profile-photo { position: relative; width: 350px; height: 350px; border-radius: 50%; overflow: hidden; border: 10px solid white; margin: -250px auto 0; z-index: 10; background: white; }
.profile-photo img { width: 100%; height: 100%; object-fit: cover; }
.info-section { text-align: center; margin-top: 10px; }
.info-section .subtitle { font-size: 16px; color: #777; margin-bottom: 5px; }
.info-section h2 { font-size: 32px; font-weight: 700; margin: 0; }
.info-section .dates { color: #555; font-size: 18px; margin-top: 8px; }
.tabs { margin-top: 25px; display: flex; justify-content: center; gap: 50px; font-size: 18px; font-weight: 600; }
.tabs button { background: none; border: none; font-size: 18px; cursor: pointer; color: #f2b927; }
.tabs .active { border-bottom: 3px solid #f2b927; padding-bottom: 5px; }
.content { max-width: 800px; margin: 50px auto; text-align: center; padding: 0 20px; }
.tab-content p { margin-bottom: 20px; line-height: 1.6; }
#acerca { text-align: left !important; }
.gallery { display: flex; flex-direction: column; align-items: center; gap: 25px; margin-top: 20px; }
.gallery img { width: 100%; max-width: 600px; height: auto; border-radius: 10px; cursor: pointer; transition: transform 0.3s, box-shadow 0.3s; }
.gallery img:hover { transform: scale(1.02); box-shadow: 0 5px 20px rgba(0,0,0,0.25); }
.footer { text-align: center; padding: 20px 0; background-color: #f8f8f8; color: #555; }
.shop-button-container { text-align: center; margin: 50px 0 30px; }
.shop-button { display: inline-block; background: linear-gradient(135deg, #d4a017, #f1c44e); color: black; font-size: 14px; font-weight: bold; padding: 8px 20px; border-radius: 50px; text-decoration: none; box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15); transition: all 0.3s ease; letter-spacing: 0.5px; }
.shop-button:hover { transform: translateY(-3px) scale(1.03); box-shadow: 0 15px 40px rgba(0, 0, 0, 0.25); }
.shop-button:active { transform: scale(0.98); }
.shop-button img { width: 30px; height: 25px; margin-right: 6px; }

/* RESPONSIVE */
@media(max-width:768px){
    body{font-size:16px;}
    .container{width:95%; padding:15px;}
    .profile-photo{width:180px;height:180px;margin:-90px auto 0;border-width:6px;}
    .info-section h2{font-size:24px;}
    .info-section .dates{font-size:15px;}
    .tabs{gap:30px;font-size:16px;}
    .content{margin-top:30px;}
    input, textarea, button{font-size:16px;}
    .header .logo { width: 100px; } /* logo aún más pequeño en móvil */
}`;


    carpeta.file("styles.css", cssContenido);

    // Descargar ZIP
    const blob = await zip.generateAsync({ type: "blob" });
    saveAs(blob, "memorial.zip");
}
</script>
</body>
</html>
